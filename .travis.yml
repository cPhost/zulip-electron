sudo: required
dist: trusty

os:
- osx
- linux

addons:
  apt:
    packages:
    - build-essential
    - libxext-dev
    - libxtst-dev
    - libxkbfile-dev

language: node_js
node_js:
- '6'

before_install:
  - ./scripts/travis-xvfb.sh
  - npm install -g gulp
  - npm install

cache:
  directories:
  - node_modules
  - app/node_modules

script:
- npm run travis
# publish only if test passes
# this will only work if GH_TOKEN is set
- electron-builder --publish always

notifications:
  webhooks:
    urls:
      - https://zulip.org/zulipbot/travis
    on_success: always
    on_failure: always
